### 🎫 TICKET #2: Member Application System Implementation

**Assignee:** Developer 2  
**Priority:** High  
**Estimated Effort:** 4-5 days  
**Type:** Backend + Frontend Feature  

---  

### 📋 Description  
Replace the current direct user registration with a member application system. Users submit applications with basic information and organization code, then wait for admin approval before gaining access to the platform.  

---  

### 🎯 Acceptance Criteria  
✅ New application status field added to User model  
✅ Application form replaces registration form  
✅ Pending applications show "Approval Awaiting" message  
✅ Restricted access for pending members  
✅ Database migration for existing users  
✅ API endpoints for application submission  

---  

### 📊 Database Schema Changes  
Update User Model (`/server/mongodb/models/User/index.ts`):
```javascript
// Add new field to userSchema
applicationStatus: {
  type: String,
  enum: ["pending", "approved", "rejected"],
  default: "pending"
},
appliedAt: { type: Date, default: Date.now },
approvedAt: { type: Date },
approvedBy: { 
  type: Schema.Types.ObjectId, 
  ref: "User" 
},
rejectionReason: { type: String }
```

---  

### 🔧 Backend Implementation  
Create Migration Script:
```javascript
// /server/mongodb/migrations/add-application-status.js
// Set existing users to "approved" status
```

Update User Creation Logic:
- `/server/actions/users_new.ts`
- Modify `createUserFromCredentials`
- Set new users to "pending" status
- Remove automatic organization assignment

New API Endpoints:
```javascript
// /src/pages/api/applications/submit.ts
POST /api/applications/submit

// /src/pages/api/applications/[id]/status.ts  
PUT /api/applications/[id]/status
```

---  

### 🎨 Frontend Implementation  
Application Form (`/src/screens/Auth/ApplicationForm.jsx`):
```jsx
// Replace registration with application form
- Remove password fields
- Add application-specific messaging
- Submit to new application endpoint
```

Pending Status Page (`/src/screens/Members/PendingApproval.jsx`):
```jsx
// Show "Approval Awaiting" message
// Display application submission date
// Provide contact information for questions
```

Access Control Middleware:
```javascript
// /src/middleware/checkApplicationStatus.js
// Redirect pending users to waiting page
// Block access to events and main features
```

---  

### 🔒 Access Control Logic  
```javascript
// In main layout component
if (user.applicationStatus === "pending") {
  return <PendingApprovalPage />;
}
if (user.applicationStatus === "rejected") {
  return <ApplicationRejectedPage />;
}
// Continue with normal app flow
```

---  

### 📁 Files to Create/Modify  
**New Files:**  
- `/src/screens/Auth/ApplicationForm.jsx`  
- `/src/screens/Members/PendingApproval.jsx`  
- `/src/screens/Members/ApplicationRejected.jsx`  
- `/src/pages/api/applications/submit.ts`  
- `/server/mongodb/migrations/add-application-status.js`  

**Modified Files:**  
- `/server/mongodb/models/User/index.ts`  
- `/server/actions/users_new.ts`  
- `/src/screens/Auth/AuthPage.jsx`  
- `/src/pages/api/users/index.ts`  

---  

### 🧪 Testing Requirements  
✅ New applications create pending users  
✅ Pending users see waiting message  
✅ Pending users cannot access events  
✅ Application form validation works  
✅ Database migration runs successfully  
✅ Existing users remain unaffected  
